*** PackageManagerService.smali	2014-08-15 13:38:34.932256248 +0800
--- PackageManagerService.smali	2014-08-15 13:40:37.604259533 +0800
***************
*** 12702,12708 ****
  
      iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;
  
!     const v10, 0x10302fc
  
      iput v10, v3, Landroid/content/pm/ActivityInfo;->theme:I
  
--- 12759,12765 ----
  
      iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;
  
!     const v10, 0x60d0020
  
      iput v10, v3, Landroid/content/pm/ActivityInfo;->theme:I
  
***************
*** 13681,13686 ****
      .end local v23           #i:I
      .end local v44           #renamed:Ljava/lang/String;
      :cond_18
      move-object/from16 v0, v41
  
      iget-object v3, v0, Lcom/android/server/pm/PackageSetting;->origPackage:Lcom/android/server/pm/PackageSettingBase;
--- 13738,13779 ----
      .end local v23           #i:I
      .end local v44           #renamed:Ljava/lang/String;
      :cond_18
+     move-object/from16 v0, p1
+ 
+     iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;
+ 
+     iget v4, v3, Landroid/content/pm/ApplicationInfo;->flags:I
+ 
+     move-object/from16 v0, v41
+ 
+     iget v10, v0, Lcom/android/server/pm/PackageSetting;->pkgFlags:I
+ 
+     const/high16 v11, -0x8000
+ 
+     and-int/2addr v10, v11
+ 
+     or-int/2addr v4, v10
+ 
+     iput v4, v3, Landroid/content/pm/ApplicationInfo;->flags:I
+ 
+     move-object/from16 v0, p1
+ 
+     iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;
+ 
+     iget v4, v3, Landroid/content/pm/ApplicationInfo;->flags:I
+ 
+     move-object/from16 v0, v41
+ 
+     iget v10, v0, Lcom/android/server/pm/PackageSetting;->pkgFlags:I
+ 
+     const/high16 v11, 0x4000
+ 
+     and-int/2addr v10, v11
+ 
+     or-int/2addr v4, v10
+ 
+     iput v4, v3, Landroid/content/pm/ApplicationInfo;->flags:I
+ 
      move-object/from16 v0, v41
  
      iget-object v3, v0, Lcom/android/server/pm/PackageSetting;->origPackage:Lcom/android/server/pm/PackageSettingBase;
***************
*** 24117,24123 ****
  
      move-result v10
  
!     if-nez v10, :cond_5
  
      .end local v1           #ai:Landroid/content/pm/ApplicationInfo;
      .end local v8           #packageName:Ljava/lang/String;
--- 24220,24226 ----
  
      move-result v10
  
!     if-eqz v10, :cond_5
  
      .end local v1           #ai:Landroid/content/pm/ApplicationInfo;
      .end local v8           #packageName:Ljava/lang/String;
